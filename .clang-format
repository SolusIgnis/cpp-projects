# -------------------------------------------------------------------
# net.telnet clang-format
# Inferred from real implementation code (FSM-heavy, C++23 modules)
# -------------------------------------------------------------------

BasedOnStyle: LLVM
Language: Cpp
#Standard: c++23

# -------------------------------------------------------------------
# Indentation
# -------------------------------------------------------------------
IndentWidth: 4
TabWidth: 4
UseTab: Never
ContinuationIndentWidth: 4

IndentCaseLabels: false
IndentCaseBlocks: false
IndentGotoLabels: false
IndentExternBlock: NoIndent

NamespaceIndentation: All
CompactNamespaces: false

AccessModifierOffset: -4

# -------------------------------------------------------------------
# Braces
# -------------------------------------------------------------------
BreakBeforeBraces: Custom
BraceWrapping:
  AfterClass: true
  AfterStruct: true
  AfterUnion: true
  AfterEnum: true
  AfterFunction: true
  AfterNamespace: true
  AfterExternBlock: true
  AfterControlStatement: false
  BeforeElse: true
  BeforeCatch: true
  SplitEmptyFunction: false
  SplitEmptyRecord: false
  SplitEmptyNamespace: false

# -------------------------------------------------------------------
# Line breaking
# -------------------------------------------------------------------
ColumnLimit: 120

BreakTemplateDeclarations: Yes

BinPackArguments: false
BinPackParameters: false
BinPackLongBracedList: false

AllowAllArgumentsOnNextLine: false
AllowAllParametersOfDeclarationOnNextLine: false
AllowAllConstructorInitializersOnNextLine: false
AllowBreakBeforeNoexceptSpecifier: OnlyWithParen
AlwaysBreakBeforeMultilineStrings: false

PackConstructorInitializers: NextLine

PenaltyBreakBeforeFirstCallParameter: 200
PenaltyBreakAssignment: 100
PenaltyBreakTemplateDeclaration: 10
PenaltyExcessCharacter: 1000000  # strongly prefer your manual wrapping

# -------------------------------------------------------------------
# Control flow readability (FSM-friendly)
# -------------------------------------------------------------------
AllowShortIfStatementsOnASingleLine: Never
AllowShortLoopsOnASingleLine: false
AllowShortCaseLabelsOnASingleLine: false
AllowShortBlocksOnASingleLine: Empty
AllowShortCompoundRequirementOnASingleLine: true
AllowShortEnumsOnASingleLine: false
AllowShortFunctionsOnASingleLine: Inline
AllowShortIfStatementsOnASingleLine: Never
AllowShortLambdasOnASingleLine: All
AllowShortLoopsOnASingleLine: true

BreakBeforeBinaryOperators: None
#BreakBinaryOperations: false

# -------------------------------------------------------------------
# Alignment
# -------------------------------------------------------------------
AlignAfterOpenBracket: Align
AlignArrayOfStructures: Right

AlignConsecutiveAssignments:
  Enabled:          true
  AcrossEmptyLines: false
  AcrossComments:   false
  AlignCompound:    true
  PadOperators:     true
AlignConsecutiveBitFields:
  Enabled:          true
  AcrossEmptyLines: false
  AcrossComments:   false
AlignConsecutiveDeclarations:
  Enabled:          false
  AcrossEmptyLines: false
  AcrossComments:   false
  AlignFunctionDeclarations: false
  AlignFunctionPointers: false
AlignConsecutiveMacros:
  Enabled:          false
  AcrossEmptyLines: false
  AcrossComments:   false
AlignConsecutiveShortCaseStatements:
  Enabled:          true
  AcrossEmptyLines: true
  AcrossComments:   false
  AlignCaseColons:  false
AlignEscapedNewlines: Left
AlignOperands: AlignAfterOperator
AlignTrailingComments:
  Kind:           Always
  OverEmptyLines: 0


# -------------------------------------------------------------------
# Spacing
# -------------------------------------------------------------------
SpaceBeforeParens: ControlStatements
SpaceBeforeParensOptions:
  AfterControlStatements: true
  AfterFunctionDeclarationName: false
  AfterFunctionDefinitionName: false
  AfterOverloadedOperator: false

SpacesInParentheses: false
SpacesInSquareBrackets: false
SpacesInAngles: false
SpacesInContainerLiterals: false
SpaceInEmptyParentheses: false

SpaceBeforeAssignmentOperators: true
SpaceAroundPointerQualifiers: Default

SpaceAfterCStyleCast: false

PointerAlignment: Left
ReferenceAlignment: Left

# -------------------------------------------------------------------
# Switch / attributes
# -------------------------------------------------------------------
#IndentCaseBlocks: false
#IndentCaseLabels: false

StatementAttributeLikeMacros:
  - likely
  - unlikely
  - fallthrough

# -------------------------------------------------------------------
# Comments & documentation
# -------------------------------------------------------------------
ReflowComments: false
KeepEmptyLinesAtTheStartOfBlocks: false
MaxEmptyLinesToKeep: 1

CommentPragmas: '^@'

# -------------------------------------------------------------------
# Includes / imports
# -------------------------------------------------------------------
SortIncludes: false
SortUsingDeclarations: false
IncludeBlocks: Preserve

# -------------------------------------------------------------------
# Modern C++ / modules
# -------------------------------------------------------------------
RequiresClausePosition: OwnLine
BreakBeforeConceptDeclarations: true
Cpp11BracedListStyle: true

# -------------------------------------------------------------------
# Misc
# -------------------------------------------------------------------
DeriveLineEnding: true
DerivePointerAlignment: false
