# -------------------------------------------------------------------
# net.telnet clang-format
# Inferred from real implementation code (FSM-heavy, C++23 modules)
# -------------------------------------------------------------------

BasedOnStyle: LLVM

Language: Cpp
Standard: Latest

# -------------------------------------------------------------------
# Indentation
# -------------------------------------------------------------------
IndentWidth: 4
TabWidth:    4
UseTab:      Never

ConstructorInitializerIndentWidth: 4

ContinuationIndentWidth: 4

IndentAccessModifiers:      false
IndentCaseBlocks:           false
IndentCaseLabels:           true
IndentGotoLabels:           false
IndentExportBlock:          true
IndentExternBlock:          Indent
IndentPPDirectives:         BeforeHash
IndentWrappedFunctionNames: true

LambdaBodyIndentation: Signature

NamespaceIndentation: All
CompactNamespaces:    false

AccessModifierOffset: -4

# -------------------------------------------------------------------
# Braces
# -------------------------------------------------------------------
BreakBeforeBraces:       Custom
BraceWrapping:
  AfterCaseLabel:        false
  AfterClass:            false
  AfterStruct:           false
  AfterUnion:            false
  AfterEnum:             false
  AfterFunction:         false
  AfterNamespace:        false
  AfterExternBlock:      false
  AfterControlStatement: Never
  BeforeElse:            false
  BeforeCatch:           false
  SplitEmptyFunction:    false
  SplitEmptyRecord:      false
  SplitEmptyNamespace:   false

# -------------------------------------------------------------------
# Line breaking
# -------------------------------------------------------------------
ColumnLimit: 120

BreakTemplateDeclarations:       Yes
BreakAdjacentStringLiterals:     false
BreakAfterAttributes:            Leave
#BreakAfterOpenBracketBracedList: false
#BreakAfterOpenBracketFunction:   false
#BreakAfterOpenBracketIf:         false
#BreakAfterOpenBracketLoop:       false
#BreakAfterOpenBracketSwitch:     false
BreakAfterReturnType:            ExceptShortType

BinPackArguments:      false
BinPackParameters:     OnePerLine
BinPackLongBracedList: false

AllowAllArgumentsOnNextLine:               false
AllowAllParametersOfDeclarationOnNextLine: false
AllowAllConstructorInitializersOnNextLine: false
AllowBreakBeforeNoexceptSpecifier:         OnlyWithParen
AlwaysBreakBeforeMultilineStrings:         false

EmptyLineAfterAccessModifier:  Never
EmptyLineBeforeAccessModifier: LogicalBlock

PackConstructorInitializers: NextLine

WrapNamespaceBodyWithEmptyLines: Never

PenaltyBreakBeforeFirstCallParameter: 200
PenaltyBreakAssignment:               100
PenaltyBreakTemplateDeclaration:      10
PenaltyExcessCharacter:               1000000  # strongly prefer your manual wrapping

# -------------------------------------------------------------------
# Control flow readability (FSM-friendly)
# -------------------------------------------------------------------
AllowShortCaseLabelsOnASingleLine:          false
AllowShortBlocksOnASingleLine:              Empty
AllowShortCompoundRequirementOnASingleLine: true
AllowShortEnumsOnASingleLine:               false
AllowShortFunctionsOnASingleLine:           Inline
AllowShortIfStatementsOnASingleLine:        Never
AllowShortLambdasOnASingleLine:             All
AllowShortLoopsOnASingleLine:               true

BreakBeforeBinaryOperators:        NonAssignment
#BreakBeforeCloseBracketBracedList: true
#BreakBeforeCloseBracketFunction:   true
#BreakBeforeCloseBracketIf:         true
#BreakBeforeCloseBracketLoop:       true
#BreakBeforeCloseBracketSwitch:     true
BreakBeforeTemplateCloser:         true
BreakBeforeTernaryOperators:       true
BreakBinaryOperations:             Never
BreakConstructorInitializers:      BeforeColon
BreakFunctionDefinitionParameters: false
BreakInheritanceList:              AfterComma
BreakStringLiterals:               false

RemoveBracesLLVM:  false
RemoveParentheses: Leave
RemoveSemicolon:   false

SeparateDefinitionBlocks: Always

# -------------------------------------------------------------------
# Alignment
# -------------------------------------------------------------------
AlignAfterOpenBracket: Align
AlignArrayOfStructures: Right

AlignConsecutiveAssignments:
  Enabled:          true
  AcrossEmptyLines: false
  AcrossComments:   false
  AlignCompound:    true
  PadOperators:     true
AlignConsecutiveBitFields:
  Enabled:          true
  AcrossEmptyLines: false
  AcrossComments:   false
AlignConsecutiveDeclarations:
  Enabled:          false
  AcrossEmptyLines: false
  AcrossComments:   false
  AlignFunctionDeclarations: false
  AlignFunctionPointers: false
AlignConsecutiveMacros:
  Enabled:          false
  AcrossEmptyLines: false
  AcrossComments:   false
AlignConsecutiveShortCaseStatements:
  Enabled:          true
  AcrossEmptyLines: true
  AcrossComments:   false
  AlignCaseColons:  false
AlignEscapedNewlines: Left
AlignOperands: AlignAfterOperator
AlignTrailingComments:
  Kind:           Always
  OverEmptyLines: 0

# -------------------------------------------------------------------
# Spacing
# -------------------------------------------------------------------
BitFieldColonSpacing: Both

SpaceAfterCStyleCast:      false
SpaceAfterLogicalNot:      false
SpaceAfterOperatorKeyword: false
SpaceAfterTemplateKeyword: false

SpaceAroundPointerQualifiers: Default

SpaceBeforeAssignmentOperators:    true
SpaceBeforeCaseColon:              false
SpaceBeforeCpp11BracedList:        false
SpaceBeforeCtorInitializerColon:   true
SpaceBeforeInheritanceColon:       true
SpaceBeforeParens:                 Custom
SpaceBeforeParensOptions:
  AfterControlStatements:          true
  AfterForeachMacros:              false
  AfterFunctionDefinitionName:     false
  AfterFunctionDeclarationName:    false
  AfterIfMacros:                   true
  AfterNot:                        true
  AfterOverloadedOperator:         false
  AfterPlacementOperator:          false
  AfterRequiresInClause:           true
  AfterRequiresInExpression:       false
  BeforeNonEmptyParentheses:       false
SpaceBeforeRangeBasedForLoopColon: true
SpaceBeforeSquareBrackets:         false
SpacesBeforeTrailingComments:      1

#SpaceInEmptyBraces:        false
SpaceInEmptyParentheses:   false
SpacesInAngles:            Never
SpacesInContainerLiterals: false
SpacesInLineCommentPrefix:
  Minimum:                 0
  Maximum:                 1
SpacesInParens:            Never
SpacesInParensOptions:
  ExceptDoubleParentheses: false
  InCStyleCasts:           false
  InConditionalStatements: false
  InEmptyParentheses:      false
  Other:                   false
SpacesInSquareBrackets:    false

PointerAlignment:   Left
ReferenceAlignment: Pointer
QualifierAlignment: Left

# -------------------------------------------------------------------
# Switch / attributes
# -------------------------------------------------------------------


# -------------------------------------------------------------------
# Comments & documentation
# -------------------------------------------------------------------
ReflowComments: IndentOnly

FixNamespaceComments: true

InsertNewlineAtEOF: true
KeepEmptyLines:
  AtEndOfFile:     true
  AtStartOfBlock:  false
  AtStartOfFile:   false
MaxEmptyLinesToKeep: 1
RemoveEmptyLinesInUnwrappedLines: true

CommentPragmas: '^@'

# -------------------------------------------------------------------
# Includes / imports
# -------------------------------------------------------------------
SortIncludes:
  Enabled:         false
  IgnoreCase:      false
#  IgnoreExtension: true
SortUsingDeclarations: Never
IncludeBlocks: Preserve

# -------------------------------------------------------------------
# Modern C++ / modules
# -------------------------------------------------------------------
RequiresClausePosition: OwnLine
IndentRequiresClause: true

RequiresExpressionIndentation: Keyword

BreakBeforeConceptDeclarations: Always
#Cpp11BracedListStyle: FunctionCall
Cpp11BracedListStyle: true

# -------------------------------------------------------------------
# Misc
# -------------------------------------------------------------------
DerivePointerAlignment: false
LineEnding: DeriveLF

IntegerLiteralSeparator:
  Binary:                 0
#  BinaryMinDigitsInsert:  0
#  BinaryMaxDigitsRemove:  0
  Decimal:                0
#  DecimalMinDigitsInsert: 0
#  DecimalMaxDigitsRemove: 0
  Hex:                    0
#  HexMinDigitsInsert:     0
#  HexMaxDigitsRemove:     0
